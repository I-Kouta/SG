### 予想問題7

---
1.手順に示すクライアントとサーバの処理と通信で可能になること  
[手順]  
1.サーバはクライアントから要求があるたびに異なる予測困難な値(チャレンジ)を生成して保持するとともに、クライアントへ送る  
2.クライアントは利用者が入力したパスワードのメッセージダイジェストを計算し、1でサーバから送られた“チャレンジ”と合わせたものから、さらにメッセージダイジェスト(レスポンス)を計算する。この"レスポンス"と利用者が入力した利用者IDをサーバに送る  
3.サーバは、クライアントから受け取った利用者IDで利用者情報を検索して、取り出したパスワードのメッセージダイジェストと1で保持していた"チャレンジ"を合わせたものから、メッセージダイジェストを計算する(レスポンス照合データ)。この"レスポンス照合データ"とクライアントから受け取った"レスポンス"とを比較する

- A.**ネットワーク上でのパスワードの、漏洩防止とリプレイ攻撃の防御**  
チャレンジレスポンス方式は、秘密にしている固定パスワードをネットワーク中に流さないようにすることで、パスワードの盗聴・リプレイ攻撃を防止する仕組み。以下の利点がある  
・平文のパスワードがネットワークを流れることがない  
・ネットワークに送信されるレスポンスは、ハッシュ関数によって生成されたメッセージダイジェストなので盗聴されても元のパスワードを再現することが困難  
・サーバからクライアントに送信されるチャレンジは毎回異なるので、ある時点のレスポンスを保存して後から送信し直すことで不正な認証を試みるリプレイ攻撃が成功する可能性が非常に低い

---
3.セキュリティ関連のプロトコルに関する記述

- A.**SSL(*Secure Sockets Layer*)は、Webサーバとブラウザとの間でデータを暗号化して転送する場合に使用することができるプロトコルである**  
主にWebブラウザとWebサーバ間でデータを安全にやり取りするための業界標準プロトコルとして使用される

- IPsecは、PPPの認証用のプロトコルの1つである  
IPを拡張してセキュリティを高め、改ざんの検知・通信データの暗号化・送信元の認証などの機能をOSI基本参照モデルのネットワーク層レベル(TCP / IPモデルのインターネット層)で提供するプロトコル

- PAP(*Password Authentication Protocol*)は、LAN間接続やダイヤルアップ接続を行う際のユーザー認証に、暗号を使用したプロトコルである  
CHAP(*Challenge Handshake Authentication Protocol*)とともに、PPPの認証で使用されるプロトコル

- PPP(*Point-to-Point Protocol*)は、暗号技術を導入してセキュリティを強化した電子メールシステムのプロトコルである  
電話回線を通じてコンピュータをネットワークに接続するダイヤルアップ接続でよく使われる、2点間を接続してデータ通信を行うための通信プロトコル

---
4.デジタルフォレンジックスでハッシュ値を利用する目的

- A.**証拠と原本との同一性を証明する**  
不正アクセスや情報漏洩などのセキュリティインシデントの発生時に、原因究明や法的根拠を明らかにするために対象となる電子的記録を収集・解析すること。ハッシュ関数は、長い文章やデータを固定長のビット列に圧縮する一方向性の関数で、ハッシュ値にデジタル署名を付けて、本人性と文書の真正性の証明に利用したり、証拠の保全・開示に広く利用されている

- 一方向性関数によってパスワードを変換して保存する  
パスワードは平文ではなくハッシュ値に変換して保存するのは盗聴や漏洩などにより第三者に知られても解読できないようにするための対策

- 改変された証拠を復元する  
ハッシュ関数は一方向性なのでハッシュ値から元のデータを復元はできない

- パスワードの盗聴の有無を検証する  
ハッシュ値には盗聴の有無を検知する仕組みはない

---
6.JIQ Q 2001:2001に規定されたリスク算定の定量的評価を、組織のセキュリティ対策の優先度を検討するリスク分析に適用したもの

- A.**被害が発生する確率と被害額で評価する**  
リスクの大きさを金額(数字)で表す評価手法。定性的評価はランク付けやレベルなどの金額以外で表す手法。被害想定を数字で表しているので定量的評価

- 過去に発生した被害件数と対策の難易度で評価する
- 攻撃に対する対処時間と被害の顕在性で評価する
- 攻撃もとの特定可否と攻撃手法の新しさで評価する  
いずれも定性的評価

---
7.ハッシュ関数を利用したメッセージ認証に関する記述

- **受信者は、ハッシュ関数を用いてメッセージからハッシュ値を生成し、送信者の公開かぎで復号したハッシュ値と比較する**  
1.送信者は、メッセージにハッシュ関数を適用してハッシュ値を生成する  
2.送信者は、`自分の秘密鍵で`ハッシュ値を暗号化しメッセージ認証コードを得る  
3.送信者は、メッセージと認証コードを合わせて受信者に送信する  
4.受信者は、送信者の公開鍵に付された認証局の公開鍵を用いて、正当性を確認する(`送信者の正当性を確認`)  
5.受信者は、`送信者の公開鍵`を用いてメッセージ認証コードを復号する  
6.受信者は、受け取ったメッセージに(送信者と同じ)ハッシュ関数を適用してハッシュ値を生成する  
7.受信者は、復号された認証コードと自分が生成したハッシュ値を比較し、同一であれば改ざんがないと判断する(`改ざんの検知`)

<img width="500" alt="" src="./images/メッセージ認証.png">

- 受信者は、送信者の公開かぎとハッシュ関数を用いてハッシュ値からメッセージを復号する  
ハッシュ値は一方向性の関数なので、ハッシュ値から元のメッセージは取得できない

- 送信者は、自分の公開かぎとハッシュ関数を用いてメッセージからハッシュ値を生成し、メッセージとともに送信する  
ハッシュ値の生成には送信者の秘密鍵を使用する

- 送信者は、ハッシュ関数を用いて送信者の秘密かぎのハッシュ値を生成し、メッセージとともに送信する  
ハッシュ値は元のメッセージをハッシュ化したもの

---
8.毎回参加者が変わる100名程度の公開セミナにおいて、参加者が持参する端末に対して無線LAN接続環境を提供する。参加者の端末以外からのアクセスポイントへの接続を防止するために効果があるセキュリティ対策

- A.**アクセスポイントがもつ暗号化機能において、参加者の端末とアクセスポイントとの間で事前に共有する鍵をセミナごとに変更する**  
無線LANにおいてはアクセスポイントと子機のもつ暗号化キーが一致した場合のみ通信を開始する。セミナ参加者の正規の端末にだけ正しい暗号化キーを設定することでアクセスポイントへの不正アクセスを遮断できる

- アクセスポイントがもつDHCPサーバ機能において、参加者の端末に対して動的に割り当てるIPアドレスの範囲をセミナごとに変更する  
参加者のものではない端末に対して、DHCPからIPアドレスが割り振られるのを防ぐことはできない

- アクセスポイントがもつURLフィルタリング機能において、参加者の端末に対する条件をセミナごとに変更する  
特定のWebサイトへのアクセスを遮断する機能。アクセスポイント自体への接続を拒否はできない

- アクセスポイントがもつプライバシーセパレータ機能において、参加者の端末へのアクセス制限をセミナごとに変更する  
同じアクセスポイントに接続している子機同士のアクセスを禁止する機能。アクセスポイント自体への接続は拒否できない

---
10.リスクマネジメントの実施内容

- A.**リスク分析では純粋リスクにとどめず、投機的リスクも対象にする**  
情報セキュリティのためのリスク分析では純粋リスクのみを対象としているが、経営主体の立場で行うリスク分析では投機的リスクも対象にする

- 将来の損失発生の危険性は不確実なものであり、対策費の予算ではなく損失額を見積もる  
リスクへの対応方法を判断するための情報として損失額、対策費の両方を見積もる必要がある

- 投機的リスクとは経営主体の管理外で発生するリスクなので、内在するリスクは管理対象外とする  
リスクマネジメントでは特質に関わらずあらゆる種類のリスクを管理対象とする

- リスクファイナンスでは、リスク分析、リスクコントロールなどのリスクマネジメントにかかる一切の費用の手当をする  
リスクファイナンスでは、リスクが顕在化した時の損失額や回復費用を他社に負担させる

---
12.VBScript(*Visual Basic Script*)で作られたコンピュータウイルスの特徴

- A.**HTML形式の電子メール本文などに埋め込まれたスクリプトによって動作する**  
プログラム言語*Visual Basic*の簡易版で*Microsoft Windows*上で動作するスクリプト言語。VBScriptで作られたコンピュータウイルスは、メール本文やWebページなどのHTML形式の文書に埋め込まれ、閲覧と同時に実行されるスクリプトによってコンピュータを感染させるという特徴を持っている

- 感染対象が実行形式ファイルであるか文書ファイルであるかにかかわらず、すべてのOSで動作する  
感染対象は*Microsoft Windows*がインストールされたコンピュータのみ

- 実行ファイルはなくワープロの文書ファイルなどに感染し、関連するアプリケーションソフトを利用して動作する  
マクロウイルスの特徴

- ブートセクタに感染して、通常のプロセス起動前にウイルスが呼び出されて動作する  
ブートセクタウイルスの特徴

---
13.JIS Q 31000:2010(リスクマネジメント - 原則及び指針)における、残留リスクの定義

- A.**リスク対応後に残るリスク**  
保有リスクとも呼ぶ

- 監査手続を実施しても監査人が重要な不備を発見できないリスク  
発見リスクの説明

- 業務の性質や本来有する特性から生じるリスク  
固有リスクの説明

- 利益を生む可能性に内在する損失発生の可能性として存在するリスク  
投機リスクの説明

---
14.JIS Q 27002における情報資産に対する脅威の説明

- A.**情報資産に害をもたらすおそれのある事象の原因**  
情報セキュリティマネジメントシステム(ISMS)を立ち上げ、実装し、運用するための情報セキュリティ管理に関するベストプラクティスを提供する。脅威(*threat*)は`システムまたは組織に損害を与える可能性があるインシデントの潜在的な原因`として定義している

- 情報資産に内在して、リスクを顕在化させる弱点  
脆弱性の説明

- リスク対策に費用をかけないでリスクを許容する選択  
リスク保有の説明

- リスク対策を適用しても解消しきれず残存するリスク  
残存リスクの説明

---
16.A社のWebサーバは、認証局で生成したWebサーバ用のデジタル証明書を使ってSSL / TLS通信を行っている。A社のWebサーバにSSL/TLSを用いてアクセスしたときのPCが、サーバのデジタル証明書を入手した後に、認証局の公開鍵を利用して行うもの

- A.**デジタル証明書の正当性を認証局の公開鍵を使って検証する**  
デジタル証明書は、公開鍵暗号方式の仕組みを利用し、公開鍵の正当性を証明するために第三者機関である認証局(CA)が発行する電子証明書。  
デジタル証明書の中には、通信を開始しようとする相手の公開鍵やそれに付随する情報などが含まれており、認証局のデジタル署名が付されている。利用者は認証局の公開鍵を使用してデジタル証明書に付されたデジタル署名を検証することで改ざんの有無や公開鍵の正当性を確認する。  
SSL / TLSではその後、共通鍵を生成し、正当性を確認した公開鍵を使用して相手と共有する。そして実際の暗号化通信にはこの共通鍵が使用されるため公開鍵を用いた暗号化通信と比較して処理負荷が軽減されるようになっている

---
18.あるコンピュータセンターでは、インシデントを6タイプに分類した  
`Scan` : プローブ、スキャン、その他の不審なアクセス  
`Abuse` : サーバプログラムの機能を悪用した不正中継  
`Forged` : 送信ヘッダを詐称した電子メールの配送  
`Intrusion` : システムへの侵入  
`DoS` : サービス運用妨害につながる攻撃  
`Other` : その他  
この時、次の3つのインシデントに対するタイプの組み合わせ  
インシデント1 : ワームの攻撃が試みられた形跡があるが、侵入されていない  
インシデント2 : ネットワークの輻輳による妨害を受けた  
インシデント3 : DoS用の踏み台プログラムがシステムに設置されていた

- A.**インシデント1 : `Scan`**  
ネットワーク内部への侵入を許したわけではなく、サーバの機能を悪用した不正中継でもないので、不審なアクセスの項目に分類される

- A.**インシデント2 : `DoS`**  
ネットワークの混雑がひどくなるとサービス提供に支障をきたす可能性がある

- A.**インシデント3 : `Instruction`**  
不正なプログラムがシステムに設置されていたということは、システムへの侵入を許したことを示している

---
19.ISMS適合性評価制度における詳細管理策の基となった国際規格

- A.**ISO / IEC17799**  
情報セキュリティ対策を行う際の実践規範を記したもので、ベストプラクティスとして様々な管理策が記載されている。ISO / IEC17799 : 2000は、JIS X 5080 : 2002としてJIS化され、ISMS適合性評価制度におけるISMS認証基準のベースになった。その後JIS Q 27002としてJIS規格化されている

- ISO 9001  
組織の品質マネジメントシステムの要求事項を定めた国際標準規格

- ISO 14001  
組織の環境マネジメントシステムの要求事項を定めた国際標準規格

- ISO / IEC 15408  
情報技術の製品及びシステムのセキュリティ特性を評価するための標準を定めた国際規格

---
21.Webサーバにおいて、機密情報を記載したページが第三者に不正利用されることを防止するためのセキュリティ対策のうち、最も適切なもの

- A.**機密情報を記載したページでは、アクセス時に利用者認証を要求する**  
第三者の不正利用を防止するには、正当な権限をもつユーザのみに対して情報資産の利用を許可するような仕組みが実装されていることが重要。これ以外の対策だと攻撃者がWebサーバへのアクセスを困難にすることができるが、正当な権限を持たない者がアクセスできてしまう

---
23.クロスサイトスクリプティングの手口に該当するもの

- A.**攻撃者が用意したスクリプトを、閲覧者のWebブラウザを介して脆弱なWebサイトに送り込み、閲覧者のWebブラウザ上でスクリプトを実行させる**  
動的にWebページを生成するアプリケーションのセキュリティ上の不備を意図的に利用し、サイト間を横断して悪意のあるスクリプトを混入させることでユーザのクッキーを盗むなどの攻撃を行う行為。脆弱性のあるWebアプリケーションでは、以下の影響を受ける可能性がある  
1.サイト攻撃者のブラウザ上で、攻撃者の用意したスクリプトの実行によりクッキー値を盗まれ、利用者が被害にあう  
2.ブラウザ上でスクリプトを実行され、サイト利用者の権限でWebアプリケーションの機能を利用される  
3.Webサイト上に偽の入力フォームが表示され、フィッシングにより利用者が個人情報を盗まれる

- 攻撃者が、スクリプトを用いてWebサイトのOSコマンドを呼び出し、任意のファイルの読出しや変更・削除などの不正操作をする  
OSコマンドインジェクションの手口

- 攻撃者が、スクリプトを用いて特定のPCへ大量に接続要求を送り出し、通信機能を停止させる  
DoS攻撃の手口

- 攻撃者が用意したスクリプトでWebサイトのサービスポートに順次アクセスし、各ポートに対応するサービスに存在するセキュリティ上の弱点を探し出す  
ポートスキャンの手口

---
24.*Man-in-the-Browser*攻撃に該当するもの

- A.**PCに侵入したマルウェアが、利用者のインターネットバンキングへのログインを検知して、Webブラウザから送信される振込先などのデータを改ざんする**  
ユーザPC内でプロキシとして動作するトロイの木馬によってWebブラウザ - Webサーバ間の送受信をブラウザベースで盗聴・改ざんする攻撃。インターネットバンキングへのログインを検知して、セッションを乗っ取り、振込先口座番号を差し替えることで、預金を不正送金するなどの攻撃例がある。送受信を改ざんする*Man-in-the-Middle*攻撃と異なり、クライアント内で書換えが行われるためWebサーバ側で不正処理を拒否することが難しい

<img width="500" alt="" src="./images/MITB攻撃.png">

- DNSサーバのキャッシュを不正に書き換えて、インターネットバンキングに見せかけた偽サイトをWebブラウザに表示させる  
DNSキャッシュッポイズニング攻撃に該当する

- インターネットバンキングから送信されたように見せかけた電子メールに偽サイトのURLを記載しておき、その偽サイトに接続させて、Webブラウザから口座番号やクレジットカード番号を入力させることで情報を盗み出す  
フィッシング攻撃に該当する

- インターネットバンキングの正規サイトに見せかけた中継サイトに接続させ、Webブラウザから入力された利用者IDとパスワードを正規サイトに転送し、利用者になりすましてログインする  
情報の搾取に中継サイトを使う*Man-in-the-Middle*攻撃(中間者攻撃)に該当する

---
26.利用者PCがボットに感染しているかどうかを*hosts*ファイルの改ざんの有無で確認するとき、*hosts*ファイルが改ざんされていないと判断できる設定内容はどれか。*hosts*ファイルには設定内容が1行だけ書かれており、利用者及びシステム管理者は、これまでに*hosts*ファイルを変更していないものとする

- A.**設定内容 : 127.0.0.1, 説明 : *localhost*は利用者PC自身を表す**  
*hosts*ファイルは、TCP / IPを利用するコンピュータにおいてIPアドレスとホスト名の対応を記述するファイル。*hosts*ファイルでは、`IPアドレス ホスト名`の形式で1つの行につき1つの対応を記述する  
IPアドレスの中で`127.0.0.1`は現在使用している自分自身のコンピュータ(*localhost*)を指定するローカル・ループバック・アドレスなので、`127.0.0.1`の対応ホストに*localhost*以外が設定されている場合は改ざんが行われた可能性が高いと判断できる。  
Windows環境ではDNSの設定よりも*hosts*ファイルの設定が優先されるので、攻撃者により*hosts*ファイルが改ざんされると不正なURLへ誘導されたり、攻撃の踏み台にされたりするなどの被害が発生する可能性がある

---
31.ICカードの情報の解読や偽造に対して、物理的に情報を保護するために機能を示すもの

- A.**耐タンパ性**  
ハードウェアやソフトウェアのセキュリティレベルを表す指標で、外部からの物理的接触により機器内部の構造を不当に解析・改変したり、重要データを取り出そうとする行為に対してどの程度の体制を有するか表す

- SECE(*Secure Electronic Commerce Environment*)  
オンライン決済の通信を行う際の国際標準的プロトコルであるSET(*Secure Electronics Transaction*)を日本独自に拡張したプロトコル

- インターロック  
誤操作や確認不足から機器に生じる誤作動を防止する安全機構。すべての扉が閉まっていなければ機械が動作を開始しない仕組みにする、などが例

- インボリューション  
共通鍵暗号のブロック暗号方式において、解読されにくい暗号文を生成するためのデータランダム化のテクニック

---
33.ビヘイビア法のウイルス検査手法に当たるもの

- A.**検査対象をメモリ上の仮想環境下で実行して、その挙動を監視する**  
ウイルスの実際の感染・発病動作を監視して検出する手法。感染・発病動作として書込み・複製・破壊動作等の動作そのものの異常を検知する場合だけでなく、感染・発病動作によって起こる環境の様々な変化を検知することによる場合も、この手法に分類される。例外ポート通信・不完パケット・通信量の異常増加・エラー量の異常増加、送信時データと受信時データの量的変化・質的変化等がそれに該当する

- あらかじめ検査対象に付加された、ウイルスに感染していないことを保証する情報と、検査対象から算出した情報とを比較する  
チェックサム法 / インテグリティチェック法の説明

- 検査対象と安全な場所に保管してあるその原本とを比較する  
コンペア法の説明

- 検査対象のハッシュ値と既知のウイルスファイルのハッシュ値とを比較する  
ハッシュ値を使用した検出手法

---
34.クロスサイトスクリプティングによる攻撃へのセキュリティ対策

- A.**Webアプリケーションで、クライアントに入力データを再表示する場合、情報内のスクリプトを無効にする処理を行う**  
動的にWebページを生成するアプリケーションのセキュリティ上の不備を意図的に利用し、サイト間を横断して悪意のあるスクリプトを混入させることでユーザのクッキーを盗むなどの攻撃を行う行為。ユーザからの入力データ内に含まれる引用符やHTMLタグを無効にせずにそのまま表示してしまうことが原因で生じるので、出力時にHTMLの特殊文字を適切にエスケープ(無効化)することで防ぐことが可能

---
35.完全一致によるパターンマッチング方式のウイルス対策ソフトは、ウイルス単体の特徴あるコード列を照合に用いる。コード列の長さと検出の関係

- A.**コード列が短いほど、正常なプログラムを誤検出する可能性が高くなる**  
コンピュータウイルスやワームを検出するための代表的な方式で、そのウイルスが持つ特徴的なコードをパターン(シグネチャコード | ウイルス定義ファイル)として検査対象のファイルを比較することでウイルスの検出を試みる。検出できるウイルスはパターンファイルに定義されているものに限るので、定義されていないものや亜種が作られるもの、未知のウイルスなどを検出するのは困難。パターンのコード列が短いとウイルスの亜種を検出できる可能性は上がるが誤報が多く、コード列が長いと誤報は少なくなるが、亜種や未知のウイルスを検出することが困難になる
