### 予想問題10

---
2.OAuth2.0において、WebサービスAの利用者Cが、WebサービスBにリソースDを所有している。利用者Cの承認の下、WebサービスAが、リソースDへの限定的なアクセス権限を取得するときのプロトコルOAuth2.0の動作

- **WebサービスBが、アクセストークンを発行する**  
異なるドメインやプラットフォーム間で、サードパーティアプリケーションによるHTTPサービスへの限定的なアクセスを可能にするオープンな認可フレームワーム。Webサイトにおいて、SNSアカウントでログインする方法で用いられる。  
ユーザ本人の認可の下、サードパーティアプリケーションに対してWebサービス側からアクセストークン(委任状のようなもの)が発行され、サードパーティアプリケーションがユーザに代わりそれを使用して、Webサービス(API)にアクセスできるようにする仕組み。3種類のロールがある  
*Resource owner* : リソースサーバ内の保護されたじょうお方へのアクセスを許可するエンドユーザで、クライアントの利用者。利用者Cが該当する  
*resource server* : 保護された情報を保持し、Webサービスを提供するアプリケーションのこと。リソースオーナを認証し、クライアントにアクセストークンを発行する認可サーバ(*authorization server*)の役割を兼ねることが多い。WebサービスBが該当する  
*client* : リソースオーナの認可を得てリソースサーバにアクセスするサードパーティアプリケーションのこと。WebサービスAが該当する<br><br>
1.利用者Cが、WebサービスAにアクセスする  
2.WebサービスAは、利用者CをWebサービスBにリダイレクトし、認証・認可手続きを促す  
3.**WebサービスBは、利用者Cの認証に成功すると、WebサービスAに対してアクセストークンを発行する**  
4.WebサービスAは、アクセストークンなどを含めたHTPリクエストをWebサービスBに送信する  
5.WebサービスBは、HTTPリクエストが正当なものであるか検証し、妥当であればリソースDを含むHTTPレスポンスをWebサービスAに返す

---
3.迷惑メールの検知手法であるベイジアンフィルタリングの説明

- A.**利用者が振り分けた迷惑メールから特徴を学習し、迷惑メールであるかどうかを統計的に解析して判定する**  
ユーザが迷惑メールに指定した電子メールの特徴を解析し、学習した内容と同等の迷惑メールを受信した時は、迷惑メールとして分類するフィルタリング。フィルタが振り分けを間違えた場合にはユーザがただいい判定をし直すことで記憶されている学習内容を更新でき、学習量が増えるほど検出制度が増す自己学習機能を備えている

- 信頼できるメール送信元を許可リストに登録しておき、許可リストにない送信元からの電子メールは迷惑メールと判定する  
ホワイトリストによる対策

- 電子メールが正規のメールサーバから送信されていることを検証し、迷惑メールであるかどうかを判定する  
SPFやDKIMによる対策

- 電子メールの第三者中継を許可しているメールサーバを登録したデータベースに掲載されている情報を基に、迷惑メールであるかどうかを判定する  
迷惑メールの発信・中継元のIPアドレスをまとめたRBL(*Realtime Blackhole List*)による対策

---
4.メールサーバ(SMTPサーバ)の不正利用を防止するために行う設定

- A.**第三者中継を禁止する**  
SMTPを使用した一部のメールサーバソフトウェアは、誰からのメールでも受け付ける初期設定になっており、当紅茶を認証する仕組みがないためネットワーク外の第三者から別の第三者へのメールを不制限に受け付け中継してしまう。第三者中継を禁止することで、迷惑メールの発信者などの不正利用からメールサーバを防ぐことができる

- ゾーン転送のアクセス元を制御する  
不正なゾーン転送を防ぐためにプライマリDNSサーバに行う設定

- ディレクトリに存在するファイル名の表示を禁止する  
Webサーバでディレクトリにアクセスした時にファイルの一覧が表示されてしまうのを防ぐための対策

- 特定のディレクトリ以外でのCGIプログラムの実行を禁止する  
Webサーバに行うパーミッション(アクセス権)の設定の説明

---
5.リモートアクセス環境において、認証情報やアカウンティング情報をやり取りするプロトコル

- A.**RADIUS**(*Remote Authentication Dial In User Service*)  
認証・利用ログの記録を単一のサーバに一元化することを目的としたプロトコル。常時接続方式のインターネット接続サービス・無線LAN・VLAN・コンテンツ提供サービスなどのサービス提供側設備において、認証とアカウンティング(利用事実の記録)を実現するプロトコルとして広く利用されている

- CHAP(*Challenge Handshake Authentication Protocol*)  
PPPで利用できる認証プロトコルで、チャレンジレスポンス方式で認証を受ける方式。認証情報をやり取りするが、アカウンティング情報に関しては規定されていない

- PAP(*Password Authentication Protocol*)  
PPPで利用できる認証プロトコルで、IDとパスワードを平文で送って認証を受ける方式。CHAPと同様に認証情報をやり取りするが、アカウンティング情報に関しては規定されていない

- PPTP(*Point - to - Point Tunneling Protocol*)  
PPPパケットをIPデータグラムでカプセル化してVPNを作り出す技術

---
6.作成者によってデジタル署名された電子文書に、タイムスタンプ機関がタイムスタンプを付与した。この電子文書を公開する場合のタイムスタンプの効果

- A.**電子文書が、タイムスタンプの時刻以前に存在したことを示すことによって、作成者が電子文書の作成を否認することを防止する**  
対象とする電子文書に対して、信頼できる第三者機関である時刻認証局(*Time Stamp Authority*)が発行する時刻情報を含んだ電子データ。付与時点での`存在性`とその時刻以後の`完全性`を証明することを目的としている

- タイムスタンプを付与した時刻以降に、作成者が電子文書の内容をほかの電子文書へコピーして流用することを防止する
- タイムスタンプを付与した時刻以降に、第三者が電子文書の内容をほかの電子文書へコピーして流用することを防止する  
電子文書の複製は防止できない

- 電子文書が、タイムスタンプの時刻以前に存在したことを示すことによって、第三者が電子文書を改ざんすることを防止する  
改竄の防止ではなく、改竄の有無を検知する

---
8.IPv4におけるIPsecのデータ形式を示している。ESPトンネルモードの電文中で、暗号化される箇所  
`新IPヘッダ | ESPヘッダ | オリジナルヘッダ | TCPヘッダ | データ | ESPトレーラ | ESP認証データ`

- A.**オリジナルIPヘッダからESPトレーラまで**  
ESP(*Encapsulating Security Payload*)は、IPsecにおいてペイロード部を暗号化するためのプロトコル。IPsecでは、トランスポートモードとトンネルモードの2つの通信モードがあり、トンネルモードでは元のIPパケットの先頭に新しいIPヘッダとESPヘッダを付加してカプセル化したパケットをIPsec対応機器同士でやり取りする方式。  
**新IPヘッダ・ESPヘッダ・ESPトレーラ・ESP認証データ**はカプセル化によって追加された情報。基本的には元のIPパケットが暗号化の対象だが、暗号処理をする際に暗号化アルゴリズムに求められるバイト長を満たすためのパディングをデータに付加しなくてはならない場合がある。このパディング部分がESPトレーラで、暗号化は元のIPパケットにESPトレーラを含めた部分を対象に行われる

<img width="500" alt="" src="./images/カプセル化.png">

---
9.ISP"A"管理下のネットワークから別のISP"B"管理下の宛先へSMTPで電子メールを送信する。電子メール送信者がSMTP - AUTHを利用していない場合、スパムメール対策OP25B(*Outbound Port 25 Blocking*)によって遮断される電子メール

- A.**ISP"A"管理下の動的IPアドレスからISP"A"のメールサーバを経由せずに送信された電子メール**  
外向き(インターネット方向)のポート25番宛(SMTP)パケットを遮断することでスパムメールを防ぐ仕組み。ISP管理下の動的IPアドレスからの電子メール送信について、管理外ネットワークのメールサーバへSMTP通信を禁止することで、ISPのメールサーバを介さずに送信側のメールサーバと直接コネクションを確立して送信されるスパムメールを防ぐ。OP25Bでは、動的IPアドレスからの送信である、ISPのメールサーバを経由しない、の2条件を満たした場合のみTCP / 25宛のパケットを遮断する。ISPのメールサーバを経由しない場合であっても、固定IPからの送信、SMTP - AUTHで認証済ノードからの送信についてはOP25Bの影響を受けない

---
11.XMLデジタル署名の特徴

- A.**XML文書中の、指定したエレメントに対して署名することができる**  
署名の対象として任意のデータファイルやXML文書全体だけでなく、XML文書の一部を対象とすることもできる。デジタル署名と同様に完全性・認証・否認防止などのセキュリティ機能を提供する。署名要素と署名対象要素の関係によって、デタッチ署名・エンベロープ署名・エンベローピング署名に分かれる

<img width="500" alt="" src="./images/署名.png">

- エンベローピング署名(Enveloping Signature)では一つの署名対象に必ず複数の署名を付ける  
署名要素の中に対象文書が格納されるので複数の署名を付することができない。複数の署名を付するのに適するのはエンベロープ署名

- 署名形式として、CMS(*Cryptographic Message Syntax*)を用いる  
XML署名として標準化された形式を用いる。CMSはインターネット標準として標準化されている電子署名の形式で、デジタル署名で使用される

- 署名対象と署名アルゴリズムをASN . 1によって記述する  
署名対象と署名アルゴリズムはXML構文で記述する。ASN . 1はプロトコル規定するために使われるデータ構造の定義言語で、デジタル署名で使用される

---
12.VLAN機能をもった1台のレイヤ3スイッチに複数のPCを接続している。スイッチのポートをグループ化して複数のセグメントに分けると、セグメントを分けない場合に比べて、どのようなセキュリティ上の効果が得られるか

- A.**スイッチが、PCからのブロードキャストパケットの到達範囲を制限するので、アドレス情報の不要な流出のリスクを低減できる**  
スイッチに接続された端末を物理的な構成に関係なくグループ化する機能、またはその機能で形成されたネットワーク。セグメントの分割を基準に幾つかの方式がある  
`ポートベースVLAN` : スイッチの接続ポート単位でグルーピング  
`アドレスベースVLAN` : MACアドレスやIPアドレスを基準にグルーピング  
`ポリシーベースVLAN` : IP, IPX, AppleTalkなどのネットワークプロトコルごとにグルーピング  
`タグVLAN` : パケット内の拡張タグに指定された情報によってグルーピング  
通常は同じスイッチに接続されているPCは同じブロードキャストドメインに属しているが、VLAN同士は異なるセグメントとして扱われるため直接の通信ができない。ブロードキャストパケットの到達範囲は同じVLANのみに限定されることになり、内部情報が異なるVLANへ流出するのを防止するセキュリティ効果が期待できる

- スイッチが、PCから送出されるICMPパケットを全て遮断するので、PC間のマルウェア感染のリスクを低減できる  
ICMPパケットはインターネット層(ネットワーク層)で動作する。PCはレイヤ3スイッチで接続されているので、ICMPパケットはレイヤ3スイッチの内部ルータを介して異なるVLAN同士に伝達される

- スイッチが、PCのMACアドレスから接続可否を判別するので、PCの不正接続のリスクを低減できる
- スイッチが、物理ポートごとに、決まったIPアドレスのPC接続だけを許可するので、PCの不正接続のリスクを低減できる  
アドレスベースVLANにおけるセキュリティ効果。ポートベースVLANでは、アドレス情報をセグメント分割の判断基準に使用しない
